<!DOCTYPE html>
<html>
<head>
	<title>Testing...</title>
</head>
<body>
	<div id="react-app"></div>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.0.1/react.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.0.1/react-dom.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.6.16/browser.js"></script>
	<script type="text/babel">
	var Contacts = [
		{key: 1, name: "James K Nelson", email: "james@jamesknelson.com", description: "Front-end Unicorn"},
		{key: 2, name: "Jim", email: "jim@example.com"},
		{key: 3, name: "Joe"},
	];

	var ContactItem = React.createClass({
		propTypes: {
			name: React.PropTypes.string.isRequired,
			email: React.PropTypes.string.isRequired,
			description: React.PropTypes.string,
		},
		render: function(){
			return(
				<div>
					<h2>{this.props.name}</h2>
					<a href='mailto:{this.props.email}'>{this.props.email}</a>
					<p>{this.props.description}</p>
				</div>
			);
		}
	});

	var Contact = React.createClass({
		render: function(){
			return (<ContactItem name={this.props.contact.name} email={this.props.contact.email} description={this.props.contact.description} />);
		}
	});

	var ContactList = React.createClass({
		render: function(){
			return(
				<ul>{Contacts.filter(function(contact){return contact.email})
					.map(function(contact){
						return <Contact contact={contact}/>
					})}
				</ul>
			)
		}
	});

	var ContactForm = React.createClass({
		getInitialState: function(){
			return{
				name:"",
				email:"",
				description:"",
			};
		},
		nameChange: function(event){
			this.setState({name:event.target.value});
		},
		emailChange: function(event){
			this.setState({email:event.target.value});
		},
		descChange: function(event){
			this.setState({description:event.target.value});
		},
		contactSubmit: function(event){
			event.preventDefault();
			var name = this.state.name.trim();
			var email = this.state.email.trim();
			if (!name || !email) {
			   return;
			}
			this.props.Submit({name:this.state.name, email:this.state.email, description:this.state.description,});
			this.setState({name:"",email:"",description:"",});
		},
		render: function(){
			return(
				<form onSubmit={this.contactSubmit}>
					<input type="text" placeholder="Name" value={this.state.name} onChange={this.nameChange} required/><br/>
					<input type="email" placeholder="Email" value={this.state.email} onChange={this.emailChange} required /><br/>
					<textarea type="text" placeholder="Description" value ={this.state.description} onChange={this.descChange} /><br/>
					<button type="submit">Add contact</button>
				</form>
			);
		}
	})

	var Root = React.createClass({
		getInitialState: function(){
			return {Contacts:Contacts};
		},
		Submit: function(contact){
			this.setState({Contacts:Contacts.push(contact)});
		},
		render:function(){
			return(
			<div>
			<h1>Contacts</h1>
			<ContactList Contacts={this.state.Contacts} />
			<ContactForm Submit={this.Submit}/>
		</div>);
		}
	});

	ReactDOM.render(<Root/>,document.getElementById("react-app"));
	</script>
</body>
</html>
